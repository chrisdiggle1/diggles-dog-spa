{% extends "base.html" %}
{% load static %}

{% block title %}
Dashboard - Diggles Dog Spa
{% endblock %}

{% block content %}
<div class="container">
    <h1>Welcome to the Dashboard</h1>

    <!-- Bookings -->
    <h2>Bookings</h2>
    <div class="row">
        {% for booking in bookings %}
        <div class="col-md-3">
            <div class="card mb-4">
                <div class="card-body text-center">
                    <h5 class="card-title">Booking ID: {{ booking.id }}</h5>
                    <p class="card-text">User: {{ booking.username.username }}</p>
                    <p class="card-text">Dog Name: {{ booking.dog_name }}</p>
                    <p class="card-text">Dog Breed: {{ booking.dog_breed }}</p>
                    <p class="card-text">Service: {{ booking.service_name }}</p>
                    <p class="card-text">Appointment Date: {{ booking.date_of_booking }}</p>
                    <p class="card-text">Appointment Time: {{ booking.appointment_time }}</p>
                    {% if booking.status == 'pending' %}
                    <form method="POST" action="{% url 'approve_booking' booking.id %}">
                        {% csrf_token %}
                        <button type="submit" class="btn btn-success">Approve</button>
                    </form>
                    <form method="POST" action="{% url 'reject_booking' booking.id %}">
                        {% csrf_token %}
                        <button type="submit" class="btn btn-danger">Reject</button>
                    </form>
                    {% elif booking.status == 'approved' %}
                    <p class="text-success">This booking has been approved.</p>
                    {% elif booking.status == 'rejected' %}
                    <p class="text-danger">This booking has been rejected.</p>
                    {% endif %}
                </div>
            </div>
        </div>
        {% endfor %}
    </div>

    <!-- Pending Approvals -->
    <h2>Pending Approvals</h2>
    <div class="row">
        {% for booking in pending_approvals %}
        <div class="col-md-3">
            <div class="card mb-4">
                <div class="card-body text-center">
                    <h5 class="card-title">Booking ID: {{ booking.id }}</h5>
                    <p class="card-text">User: {{ booking.username.username }}</p>
                    <p class="card-text">Dog Name: {{ booking.dog_name }}</p>
                    <p class="card-text">Dog Breed: {{ booking.dog_breed }}</p>
                    <p class="card-text">Service: {{ booking.service_name }}</p>
                    <p class="card-text">Appointment Date: {{ booking.date_of_booking }}</p>
                    <p class="card-text">Appointment Time: {{ booking.appointment_time }}</p>
                    <form method="POST" action="{% url 'approve_booking' booking.id %}">
                        {% csrf_token %}
                        <button type="submit" class="btn btn-success">Approve</button>
                    </form>
                    <form method="POST" action="{% url 'reject_booking' booking.id %}">
                        {% csrf_token %}
                        <button type="submit" class="btn btn-danger">Reject</button>
                    </form>
                </div>
            </div>
        </div>
        {% endfor %}
    </div>

    <!-- Services -->
    <h2>Services</h2>
    <div class="row">
        {% for service in services %}
        <div class="col-md-3">
            <div class="card mb-4">
                <div class="card-body text-center">
                    <h5 class="card-title">{{ service.service_name }}</h5>
                    <p class="card-text">Cost: {{ service.cost }}</p>
                    <p class="card-text">Description: {{ service.description }}</p>
                    <p class="card-text">Duration: {{ service.formatted_duration }}</p>
                    <form method="POST" action="{% url 'delete_service' service.id %}">
                        {% csrf_token %}
                        <button type="submit" class="btn btn-danger">Delete</button>
                    </form>
                </div>
            </div>
        </div>
        {% endfor %}
    </div>
</div>
{% endblock %}